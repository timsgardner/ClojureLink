(* mostly from http://clojure.org/reader *)

<word-H> = keyword | symbol | number | quote | character | deref | metadata | dispatch-H | syntax-quote | 

number = #"[0-9]+(?:\.[0-9]+)?(?:e[0-9]+)?"

keyword = #":.*"

(* This definition is laxer than usual because we've already eliminated a lot of annoying other cases by the time we get to this sub-grammar *)

symbol = #"[\w&&[^0-9][*+!-_?/.]].*"

(* metadata maps can contain arbitrary clojure forms, so this isn't the stage to handle them. Eventually that'll just be a matter of retyping [:word "^" [:map ...]] forms. For now just deal with tags. *)

metadata = #'^.*'

<dispatch-H> = var-quote | ignore

var-quote = "#'" symbol

ignore = "#_"

(* I dont like the next bit, it's going to make a stupid AST *)

syntax-quote = '`' symbol?

unquote = '~' symbol?

unquote-splicing = '~@' symbol?


